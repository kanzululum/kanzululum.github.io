{"version":3,"file":"Login-BHdunpya.js","sources":["../../src/global/firebase/auth/signIn.js","../../src/app/user-pages/Login.jsx"],"sourcesContent":["import firebase from \"../firebase\"\r\n\r\nexport const signIn = async (email, password) => {\r\n  try {\r\n    const result = await firebase\r\n      .auth()\r\n      .signInWithEmailAndPassword(email, password)\r\n    return {}\r\n  } catch (e) {\r\n    console.log(e.toString())\r\n    throw new Error(\"Error signing in: \" + e)\r\n  }\r\n}\r\n","import { Button, Form } from \"react-bootstrap\"\nimport { useState, useEffect } from \"react\"\nimport { signIn, useAuth } from \"../../global/firebase/auth\"\nimport { useNavigate } from \"react-router-dom\"\nimport Spinner from \"../shared/Spinner\"\nimport { getCurrentSetting } from \"../../global/firebase/setting\"\n\nexport const Login = ({}) => {\n  const [validationErrors, setValidationErrors] = useState({})\n  // const [cookies, setCookie] = useCookies([\"uid\", \"requestToken\"])\n  const { isLoading, user } = useAuth()\n  const isLogedIn = !!user\n\n  const [errorMessages, setErrorMessages] = useState([])\n  const [logingIn, setLogingIn] = useState(false)\n\n  // const [username, setUsername] = useState(\"\")\n  const [email, setEmail] = useState(\"\")\n  const [password, setPassword] = useState(\"\")\n  const navigate = useNavigate()\n  const main = () => {\n    setTimeout(() => {\n      try {\n        document.querySelector(`input.email`).focus()\n      } catch (e) {}\n    }, 512)\n    // console.log(config)\n  }\n  const doForgetPassword = () => {\n    setErrorMessages([\"Sayang sekali sepertinya anda harus tanya admin untuk reset password anda\"])\n  }\n  const onLogin = async () => {\n    setValidationErrors(null)\n    setErrorMessages([])\n    let errorCount = 0\n    let verrors = {}\n    if (email.length == 0) {\n      errorCount += 1\n      verrors = { ...verrors, email: { message: \"Email is required\" } }\n    }\n    if (password.length == 0) {\n      errorCount += 1\n      verrors = { ...verrors, password: { message: \"Password is required\" } }\n    }\n    console.log(errorCount)\n    if (errorCount > 0) {\n      setValidationErrors({ ...verrors })\n      console.log(validationErrors)\n      const firstField = Object.keys(validationErrors)[0]\n      setTimeout(() => {\n        try {\n          document.querySelector(`input.${firstField}`).focus()\n        } catch (e) {\n          console.error(e)\n        }\n      }, 512)\n    } else {\n      setLogingIn(true)\n      try {\n        await signIn(email, password)\n        // setCookie(\"uid\", result.id)\n        const { repoUrl, token, corsProxyUrl } = await getCurrentSetting()\n        localStorage.repoUrl = repoUrl\n        localStorage.token = token\n        localStorage.corsProxyUrl = corsProxyUrl\n        // navigate(\"/\")\n        document.location.href = \"/purple\"\n      } catch (e) {\n        const message = e.message.replace(\"FirebaseError:\", \"\").replace(\"Firebase:\", \"\")\n        setEmail(email)\n        setErrorMessages([message])\n        try {\n          document.querySelector(`input.email`).focus()\n        } catch (e) {}\n      }\n      setLogingIn(false)\n    }\n    // console.log(email, password)\n  }\n  useEffect(() => {\n    main()\n  }, [])\n\n  useEffect(() => {\n    if (isLogedIn) {\n      navigate(\"/\")\n      // document.location.reload()\n    }\n  }, [isLogedIn])\n  return (\n    <div>\n      <div className=\"d-flex align-items-center auth px-0\">\n        <div className=\"row w-100 mx-0\">\n          <div className=\"col-lg-4 mx-auto\">\n            <div className=\"auth-form-light text-left py-5 px-4 px-sm-5 twx-relative\">\n              <div className=\"brand-logo\">\n                <img className=\"twx-mx-auto\" src=\"/assets/images/logo/logo-dark.png\" alt=\"logo\" />\n              </div>\n              <div className=\"twx-text-center\">\n                {/* <h4 className=\"twx-mx-auto\">Hello! let's get started</h4> */}\n                <h6 className=\"font-weight-light\">Login untuk melanjutkan</h6>\n              </div>\n              {logingIn ? (\n                <>\n                  <Spinner independent={true} message=\"Sedang Login\" />\n                </>\n              ) : (\n                <Form\n                  className=\"pt-3\"\n                  onSubmit={(e) => {\n                    try {\n                      console.log(\"hello\")\n                      onLogin()\n                    } catch (e) {}\n                    return e.preventDefault()\n                  }}>\n                  <Form.Group className=\"d-flex search-field\">\n                    <Form.Control\n                      type=\"email\"\n                      placeholder=\"Email\"\n                      size=\"lg\"\n                      className=\"h-auto email\"\n                      onChange={(e) => setEmail(e.target.value)}\n                    />\n                  </Form.Group>\n                  <Form.Group className=\"d-flex search-field\">\n                    <Form.Control\n                      type=\"password\"\n                      placeholder=\"Kata Sandi\"\n                      size=\"lg\"\n                      className=\"h-auto password\"\n                      onChange={(e) => setPassword(e.target.value)}\n                    />\n                  </Form.Group>\n                  <Form.Group className=\"d-flex search-field\">\n                    {errorMessages.map((item, index) => {\n                      return (\n                        <div className=\"alert alert-danger\" key={index}>\n                          {item}\n                        </div>\n                      )\n                    })}\n                  </Form.Group>\n                  <div className=\"mt-3\">\n                    <Button\n                      type=\"submit\"\n                      size=\"sm\"\n                      className=\"text-center btn btn-block btn-primary btn-lg font-weight-medium auth-form-btn\">\n                      <span className=\"twx-mx-auto\">LOG IN</span>\n                    </Button>\n                  </div>\n                  {/* <div className=\"my-2 d-flex justify-content-between align-items-center\">\n                    <div className=\"form-check\">\n                      <label className=\"form-check-label text-muted\">\n                        <input type=\"checkbox\" className=\"form-check-input\" />\n                        <i className=\"input-helper\"></i>\n                        Keep me signed in\n                      </label>\n                    </div>\n                    <a href=\"!#\" onClick={(event) => event.preventDefault()} className=\"auth-link text-black\">\n                      Forgot password?\n                    </a>\n                  </div>\n                  <div className=\"mb-2\">\n                    <button type=\"button\" className=\"btn btn-block btn-facebook auth-form-btn\">\n                      <i className=\"mdi mdi-facebook mr-2\"></i>Connect using facebook\n                    </button>\n                  </div>\n                  <div className=\"text-center mt-4 font-weight-light\">\n                    Don't have an account?{\" \"}\n                    <Link to=\"/user-pages/register\" className=\"text-primary\">\n                      Create\n                    </Link>\n                  </div> */}\n                </Form>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default Login\n"],"names":["signIn","email","password","result","firebase","e","Login","validationErrors","setValidationErrors","useState","isLoading","user","useAuth","isLogedIn","errorMessages","setErrorMessages","logingIn","setLogingIn","setEmail","setPassword","navigate","useNavigate","main","onLogin","errorCount","verrors","firstField","repoUrl","token","corsProxyUrl","getCurrentSetting","message","useEffect","jsx","jsxs","Spinner","Form","item","index","Button"],"mappings":"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"}